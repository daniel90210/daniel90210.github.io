<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chess Game</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #121212;
            overflow: hidden;
        }

        .chess-container {
            display: flex;
            justify-content: center;
            align-items: center;
            max-width: 80vh; /* Ensures it doesn't get too large */
            width: 100%;
        }

        .chessboard {
            display: grid;
            grid-template-columns: repeat(8, min(10vw, 7vh));
            grid-template-rows: repeat(8, min(10vw, 7vh));
            gap: 0;
            box-shadow: 0px 0px 10px rgba(255, 255, 255, 0.1); /* Soft shadow instead of border */
        }

        .square {
            width: min(10vw, 7vh);
            height: min(10vw, 7vh);
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .white {
            background-color: #FFFED8;
           background-image: radial-gradient(rgba(255,255,255,0.5) 10%, transparent 70%),
                      linear-gradient(45deg, rgba(200, 200, 200, 0.2) 25%, transparent 25%);
    }

        .black {
            background-color: #51B02B;
            background-image: radial-gradient(rgba(81, 176, 43, 0.5) 10%, transparent 70%),
                      linear-gradient(45deg, rgba(30, 100, 20, 0.2) 25%, transparent 25%);
        }

        .piece {
            width: 90%;
            height: 90%;
            background-size: cover;
            background-position: center;
        }

        #comments {
            margin-top: 20px;
            font-size: 1.2em;
            color: #fff;
        }
    </style>
</head>
<body>
    <div class="chess-container">
        <div id="chessboard" class="chessboard"></div>
    </div>
    <div id="comments"></div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.10.3/chess.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/stockfish.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const boardElement = document.getElementById('chessboard');
            const commentsElement = document.getElementById('comments');
            const chess = new Chess();
            const stockfish = new Worker("https://cdn.jsdelivr.net/npm/stockfish.js");
            let gameOver = false;

            const initialBoard = [
                ['bc', 'bkn', 'bb', 'bq', 'bk', 'bb', 'bkn', 'bc'],
                ['bp', 'bp', 'bp', 'bp', 'bp', 'bp', 'bp', 'bp'],
                ['--', '--', '--', '--', '--', '--', '--', '--'],
                ['--', '--', '--', '--', '--', '--', '--', '--'],
                ['--', '--', '--', '--', '--', '--', '--', '--'],
                ['--', '--', '--', '--', '--', '--', '--', '--'],
                ['wp', 'wp', 'wp', 'wp', 'wp', 'wp', 'wp', 'wp'],
                ['wc', 'wkn', 'wb', 'wq', 'wk', 'wb', 'wkn', 'wc']
            ];

            const pieceImages = {
                'wp': 'pieces/wp.PNG',
                'wkn': 'pieces/wkn.PNG',
                'wb': 'pieces/wb.PNG',
                'wq': 'pieces/wq.PNG',
                'wk': 'pieces/wk.PNG',
                'wc': 'pieces/wc.PNG',
                'bp': 'pieces/bp.PNG',
                'bkn': 'pieces/bkn.PNG',
                'bb': 'pieces/bb.PNG',
                'bq': 'pieces/bq.PNG',
                'bk': 'pieces/bk.PNG',
                'bc': 'pieces/bc.PNG',
                '--': ''
            };

            // Create the board
            function createBoard() {
                boardElement.innerHTML = '';
                for (let row = 0; row < 8; row++) {
                    for (let col = 0; col < 8; col++) {
                        const square = document.createElement('div');
                        const piece = initialBoard[row][col];
                        square.classList.add('square');
                        square.classList.add((row + col) % 2 === 0 ? 'white' : 'black');

                        if (piece !== '--') {
                            const img = document.createElement('img');
                            img.src = pieceImages[piece];
                            img.alt = piece;
                            img.classList.add('piece');
                            square.appendChild(img);
                        }

                        boardElement.appendChild(square);
                    }
                }
            }

            // Function to update the board and show commentary
            function updateBoard() {
                const board = chess.board();
                boardElement.innerHTML = '';
                createBoard();
                for (let i = 0; i < 64; i++) {
                    const square = boardElement.children[i];
                    const piece = board[Math.floor(i / 8)][i % 8];
                    if (piece) {
                        const img = document.createElement('img');
                        img.src = pieceImages[piece.color + piece.type];
                        img.classList.add('piece');
                        square.appendChild(img);
                    }
                }
            }

            // AI Move Functionality
            function makeMove() {
                if (gameOver) return;

                const moves = chess.ugly_moves();
                const move = moves.length === 0 ? null : moves[0]; // Take the first available move
                if (move) {
                    chess.ugly_move(move);
                    updateBoard();
                    stockfish.postMessage("position fen " + chess.fen());
                    stockfish.postMessage("go depth 5"); // Set AI depth for beginner level
                }
            }

            // Handle Stockfish's response
            stockfish.onmessage = function (event) {
                if (event.data.includes("bestmove")) {
                    const bestMove = event.data.split(" ")[1];
                    chess.ugly_move(chess.move(bestMove));
                    updateBoard();
                    commentsElement.innerHTML = `S.T.A.N.'s Move: ${bestMove} - Stay fresh, stay bold!`;
                }
            };

            // Start the game
            createBoard();
            updateBoard();
            makeMove(); // AI's first move
        });
    </script>
</body>
</html>
